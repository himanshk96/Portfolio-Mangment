<br>
<h1>My Portfolio</h1>
<div *ngIf="loaded else loading">


    <div *ngFor="let p of portfolio_data | keyvalue" class="card_padding">
        <!-- {{i}} {{p.name}} -->
        <div class="card w-100 h-50" (click)="callDetails(p.tickername)">
            <div class="card-header">
                <h1>{{p.key}}</h1>
            </div>
            <div class="card-body">
                <div class="row">
                    <div class="col">
                        <div class="d-flex justify-content-between">
                            <div> Quantity:<br>
                                Avg. Cost/Share:<br>
                                Total Cost:<br>
                            </div>
                            <div class="text-right">
                                {{getQuantity(p.key)}}
                                <br>
                                {{getTotalPrice(p.key)/getQuantity(p.key)| number : '1.2-2'}}
                                <br>
                                {{getTotalPrice(p.key) | number : '1.2-2'}}
                            </div>
                        </div>

                    </div>
                    <div class="col">
                        <div class="d-flex justify-content-between">
                            <div>
                                Change:<br>
                                Current Price:<br>
                                Market Value:
                            </div>
                            <div class="text-right" [ngClass]="{
                                'blac_' : (port_data[p.key]['last']-getTotalPrice(p.key)/getQuantity(p.key))   ==0 ,
                                'positive' : (port_data[p.key]['last']-getTotalPrice(p.key)/getQuantity(p.key) ) > 0,
                                'negative' : (port_data[p.key]['last']-getTotalPrice(p.key)/getQuantity(p.key)) < 0
                                
                             }">
                                <span
                                    *ngIf="(port_data[p.key]['last']-getTotalPrice(p.key)/getQuantity(p.key) ) >0 else neg_img">
                                    <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-caret-up-fill"
                                        fill="green" xmlns="http://www.w3.org/2000/svg">
                                        <path
                                            d="M7.247 4.86l-4.796 5.481c-.566.647-.106 1.659.753 1.659h9.592a1 1 0 0 0 .753-1.659l-4.796-5.48a1 1 0 0 0-1.506 0z" />
                                    </svg></span>
                                {{port_data[p.key]["last"]-getTotalPrice(p.key)/getQuantity(p.key) | number : '1.2-2'}}
                                <br>
                                {{port_data[p.key]["last"]}}
                                <br>
                                {{port_data[p.key]["last"] * getQuantity(p.key) | number : '1.2-2'}}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="card-footer text-right">

                <button type="button" class="btn btn-primary">Buy</button> &nbsp;
                <button type="button" class="btn btn-danger">Sell</button>

            </div>

        </div>
        <br>
    </div>
</div>
<ng-template #loading>
    <br>
    <br>
    <br>
    <br>

    <mat-spinner style="margin:0 auto"></mat-spinner>
</ng-template>